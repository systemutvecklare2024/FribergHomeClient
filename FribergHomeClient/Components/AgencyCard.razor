@using static FribergHomeClient.Data.StatusTypes

@* Author: Tobias
CoAuthor: Emelie *@

<RadzenCard Variant="Variant.Filled" class="rz-my-12 rz-mx-auto" Style="max-width: 1200px">
    <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Start" Gap="1rem" class="rz-p-4">
        <RadzenImage Path="@LogoUrl" Style="width: 100px; height: 100px; border-radius: 50%;" />
        <RadzenStack Gap="0">
            <RadzenText TextStyle="TextStyle.Body1"><b>@(Name)</b></RadzenText>
            <RadzenText TextStyle="TextStyle.Overline" class="rz-display-flex rz-mt-4 rz-mb-0">Presentation</RadzenText>
            <RadzenText TextStyle="TextStyle.Body1"><b>@Presentation</b></RadzenText>
        </RadzenStack>
    </RadzenStack>
    <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Start" Gap="1rem" class="rz-p-4">
        @if(pendingApplications != null && pendingApplications.Any())
        {
            <ListApplications Applications="@pendingApplications"/>
        }
    </RadzenStack>
</RadzenCard>


@code {
    [Parameter]
    public string? Name { get; set; }
    [Parameter]
    public string? Presentation { get; set; }
    [Parameter]
    public string? LogoUrl { get; set; }
    [Parameter]
    public List<ApplicationDTO> Applications { get; set; }

    private List<ApplicationDTO> pendingApplications = [];

    protected override void OnInitialized()
    {
        if(Applications != null && Applications.Any())
            SelectPendingApplications(Applications);
    }

    private void SelectPendingApplications(List<ApplicationDTO> applications)
    {
        pendingApplications = applications.Where(a => a.StatusType == StatusType.Pending).ToList();
        StateHasChanged();
    }

}
